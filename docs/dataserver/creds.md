# Ресурс "Реквизиты Источника" (credentials)

Ресурс содержит список **Рекивизитов Источника** - записей, связывающих **Контексты Источника** с Линками сервиса `drvComm`.

Каждая запись имеет следующие поля:

* `crid`  - уникальный идентификатор записи о Реквизите
* `name`  - наименование Реквизита (никнейм)
* `ctxid` - Контекст  Реквизита
* `lid`   - Линк Реквизита
* `login` - логин Реквизита
* `pass`  - пароль Реквизита
* `data`  - данные связанные с Реквизитом

В поле `ctxid` хранится идентификатор Контекста Источника, к которому привязан Реквизит 

В поле `lid` хранится идентификатор Линка сервиса `drvComm`, к которому привязан Реквизит 

В поле логин Реквизита в поле `login` хранится идентификатор с которым этот привязанный объект входит в систему (подключается к линку)

### Формат поля `data`:

```json
{
  "data": {
    "def": "Описание Реквизита"
  }
}
```

**Запросы**

## 1. Список Реквизитов

**Назначение:** для получения списка Реквизитов.

**Запрос** `api/v2/sources/contexts/creds/list`

**Тип запроса:** POST

**Параметры**: нет

**Тело запроса:**

```json
{
    "ctxid": [
        "010904c5-cf65-400b-9cc2-00ebd753f262"
    ]
}
```

**Возможные параметры тела запроса**:

| **имя поля**   | **тип**    | **описание**                                                               |
|----------------|------------|----------------------------------------------------------------------------|
| `ctxid`        | `[]uuid`   | список идентификаторов Контекстов                                       | 

**Пример:**
`api/v2/sources/contexts/creds/list`

**Ответ:**

```json

{
  "meta": {},
  "response": {
    "credentials": {
      "info": {
        "page": 0,
        "pagecount": 1,
        "pagesize": 100,
        "total": 3
      },
      "items": [
                {
                    "compid": "85697f9f-b80d-4668-8ed2-2f70ed825eee",
                    "crid": "7418a0b1-7a96-11f0-9790-02420a000107",
                    "ctxid": "010904c5-cf65-400b-9cc2-00ebd753f262",
                    "data": {
                        "def": "Описание Реквизита Источника"
                    },
                    "lid": "ee413b33-8660-42be-84cb-3c92fc81134f",
                    "login": "sm002410",
                    "name": "Реквизит Источника для Себы",
                    "created": 1755344705,
                    "updated": 1755345048
                },
                {
                    "compid": "85697f9f-b80d-4668-8ed2-2f70ed825eee",
                    "crid": "7418a0b1-7a96-11f0-9790-02420a000107",
                    "ctxid": "010904c5-cf65-400b-9cc2-00ebd753f262",
                    "data": {
                        "def": "Описание Реквизита Источника"
                    },
                    "lid": "ee413b33-8660-42be-84cb-3c92fc81134f",
                    "login": "sm002410",
                    "name": "Реквизит Источника для Себы",
                    "created": 1755344705,
                    "updated": 1755345048
                }
      ]
    }
  }
}

```

**Возможные поля ответа:**

| **имя поля** | **тип**       | **описание**                                                        |
|--------------|---------------|---------------------------------------------------------------------|
| `page`       | `string`      | текущий номер страницы (дублирует параметр запроса)                 |
| `pagecount`  | `string`      | общее число страниц (зависит от размера pagesize)                   |
| `pagesize`   | `string`      | сколько элементов выдавать на странице (дублирует параметр запроса) |
| `total`      | `string`      | всего элементов в таблице                                           |
| `crid`       | `uuid`        | уникальный идентификатор Реквизита                               |
| `compid`     | `uuid`        | идентификатор организации, которой принадлежит Реквизит         |
| `lid`        | `integer`     | Линк  Реквизита - идентификатор Владельца                      |
| `name`       | `string[255]` | наименование Реквизита (никнейм)                                 |
| `ctxid`      | `uuid`        | Контекст  Реквизита                                                  |
| `login`      | `string[255]` | логин Реквизита                                                  |
| `data`       | `json`        | данные Реквизита                                                 |

## 2. Информация по указанному Реквизиту

**Назначение:** для получения информации по указанному Реквизиту.

**Запрос** `api/v2/sources/contexts/creds/CRID_ID`

**Тип запроса:** GET

**Возможные параметры:**  нет

**Пример:**  `api/v2/sources/contexts/creds/dea50f0c-f55f-4063-9f17-e45ae8c03bce`

**Ответ:**

```json

{
  "meta": {},
    "response": {
        "credential": {
            "body": {},
            "compid": "85697f9f-b80d-4668-8ed2-2f70ed825eee",
            "created": 1755344705,
            "crid": "7418a0b1-7a96-11f0-9790-02420a000107",
            "ctxid": "010904c5-cf65-400b-9cc2-00ebd753f262",
            "data": {
                "def": "Описание Реквизита Источника"
            },
            "lid": "ee413b33-8660-42be-84cb-3c92fc81134f",
            "login": "sm002410",
            "name": "Реквизит Источника для Себы",
            "pass": "null",
            "updated": 1755345048
        }
    }
}

```

**Возможные поля ответа:**

| **имя поля** | **тип**       | **описание**                                                |
|--------------|---------------|-------------------------------------------------------------|
| `crid`       | `uuid`        | уникальный идентификатор Реквизита                               |
| `compid`     | `uuid`        | идентификатор организации, которой принадлежит Реквизит         |
| `lid`        | `integer`     | Линк  Реквизита - идентификатор Владельца                      |
| `name`       | `string[255]` | наименование Реквизита (никнейм)                                 |
| `ctxid`      | `uuid`        | Контекст  Реквизита                                                  |
| `login`      | `string[255]` | логин Реквизита                                                  |
| `data`       | `json`        | данные Реквизита                                                 |

## 3. Создать новую запись о Реквизите

**Назначение:** для регистрации нового Реквизита

**Запрос** `api/v2/sources/contexts/creds/new`

**Тип запроса:** POST

**Параметры запроса:** нет

**Пример:**  `api/v2/sources/contexts/creds/new

Передаваемые данные:

```json

{
  "name": "Реквизит Источника для Себы",
  "lid": "ee413b33-8660-42be-84cb-3c92fc81134f",
  "ctxid": "010904c5-cf65-400b-9cc2-00ebd753f262",
  "login": "sm002410",
  "pass": "null",
  "data": {
    "def": "Описание Реквизита Источника"
  },
  "body": {}
}


```

**Ответ:**

```json

{
  "meta": {},
  "response": {
    "credential": {
      "crid": "dea50f0c-f55f-4063-9f17-e45ae8c03bce"
    }
  }
}

``` 

**Обязательные параметры:**

| **имя поля** | **тип**       | **описание**                                                |
|--------------|---------------|-------------------------------------------------------------|
| `lid`        | `uuid`        | Линк  Реквизита                   |
| `ctxid`      | `uuid`        | Контекст  Реквизита                                                  |
| `login`      | `string[255]` | логин Реквизита                                          |
| `pass`       | `string[255]` | пароль Реквизита                                         |
| `data`       | `json`        | данные Реквизита                                         |

**Необязательные параметры:**

| **имя поля** | **тип**       | **описание**                          |
|--------------|---------------|---------------------------------------|
| `crid`       | `uuid`        | уникальный идентификатор Реквизита |
| `name`       | `string[255]` | наименование Реквизита (никнейм)   |
| `body`       | `json`        | расширенные данные Реквизита                             |

Если при создании Реквизите не указывается `name` то он должен устанаваливаться в значение `login`

**Поля ответа:**

| **имя поля** | **тип** | **описание**                          |
|--------------|---------|---------------------------------------|
| `crid`       | uuid    | уникальный идентификатор Реквизита |

## 4. Обновить информацию об Реквизите

**Назначение:** для обновления информации об Реквизите. Обновляются указанные в запросе поля.

Невозможно обновить поля `crid`, `lid` и `ctxid`

**Запрос** `api/v2/sources/contexts/creds/CRID_ID/update`

где 
* `CRID_ID` – идентификатор Реквизита

**Тип запроса:** POST

**Пример:**  `api/v2/sources/contexts/creds/dea50f0c-f55f-4063-9f17-e45ae8c03bce/update`

Передаваемые данные:

```json

{
  "name": "SimpleUser",
  "login": "demo@example.com",
  "pass": "MyPassword",
  "data": {
    "def": "Описание Реквизита"
  },
  "body": { }
}
```

**Ответ:**

```json

{}

```

**Возможные поля запроса:**

| **имя поля** | **тип**       | **описание**                                             |
|--------------|---------------|----------------------------------------------------------|
| `name`       | `string[255]` | наименование Реквизита (никнейм)   |
| `login`      | `string[255]` | логин Реквизита                                       |
| `pass`       | `string[255]` | пароль Реквизита                                      |
| `data`       | `json`        | данные Реквизита                                      |
| `body`       | `json`        | расширенные данные Реквизита                          |

## 5. Удалить запись о Реквизите

**Назначение:** для удаления ранее архивированной записи ое Реквизите

**Запрос** `api/v2/sources/contexts/creds/CRID_ID/remove`

где 
* `CRID_ID` – идентификатор Реквизита

**Тип запроса:** POST

**Параметры запроса:**

| **имя поля** | **тип** | **описание**                          |
|--------------|---------|---------------------------------------|
| `crid`       | `uuid`  | уникальный идентификатор Реквизита |

**Пример:**  `api/v2/sources/contexts/creds/rem?crid=dea50f0c-f55f-4063-9f17-e45ae8c03bce`

**Ответ:**

```json

{}

```