# Ресурс "Оборудование" (equipments)

Ресурс содержит список оборудования

С каждым экземпляром оборудования может быть связан Узел сети (host) с уникальным идентификатором **hid**.

Этот же идентификатор  **hid** используется для создания сессий синхронизации.

Это актуально для всевозможных АРМов, которые используют Хранилище для хранения данных на локальном диске и дальнейшей
синхронизации с Датасервером.

Каждый экземпляр оборудования может иметь ссылку на другой экземпляр оборудования в поле **owner** которое говорит о
том, что текущий экземпляр оборудования подключен к указанному в **owner**. Например, термометр может быть подключен к
контроллеру. В этому случае у термометра **owner** будет указывать на идентификатор контроллера. Таким образом могут
строиться цепочки любой длины.

Оборудование может быть привязано к транспорту или персоналу (например, трекер, который устанавливается на автомобиль).
В этом случае поле **set_to** содержит идентификатор оборудования или персонала, к которому привязано оборудование.

Каждый тип оборудования может быть включен в некоторую группу оборудования (например, группа "Термометры"). Каждая
группа оборудования может быть включена в любую другую группу но не более чем один уровень включения.

С каждым экземпляром оборудования может быть связана группа файлов **docs**, которая представляет собой ссылку на группу
файлов, связанную с оборудованием.

**Статусы оборудования**:

* EQU_STS_UNKNOWN (неизвестный),
* EQU_STS_OK (исправно),
* EQU_STS_FAULT (неисправно),
* EQU_STS_UNREG (списано),
* EQU_STS_RECYC (утилизированно)

**Местоположение оборудования**:

* EQU_LOC_UNKNOWN (неизвестный),
* EQU_LOC_INWORK (в эксплуатации),
* EQU_LOC_INREPAIR (в ремонте),
* EQU_LOC_INSTOR (на хранении),
* EQU_LOC_INCHECK (на поверке)

Полный список статусов и местоположений оборудования можно получить соответствующим запросом

Над оборудованием можно выполнять действия (**acts**) которые фиксируются в ресурсе "Действия"и позволяют получить
информацию с производимыми надо оборудованием действиями (перемещение, изменение статуса и пр.)

**Запросы**

## 1. Список определений ресурса

**Назначение:** для получения списка определений для ресурса "Оборудование".

**Запрос**: `/api/v1/equipments/defs/list`

**Тип запроса:** GET

**Ответ:**

```json

{
  "meta": {},
  "response": {
    "statuses": {
      "items": [
        {
          "stsid": "EQU_STS_UNKNOWN",
          "caption": "неизвестно",
          "def": "Статус оборудования не известен"
        },
        {
          "stsid": "EQU_STS_OK",
          "caption": "исправно",
          "def": "Оборудование исправно"
        },
        {
          "stsid": "EQU_STS_FAULT",
          "caption": "неисправно",
          "def": "Оборудование неисправно"
        },
        {
          "stsid": "EQU_STS_UNREG",
          "caption": "списано",
          "def": "Оборудование списано"
        },
        {
          "stsid": "EQU_STS_RECYC",
          "caption": "утилизировано",
          "def": "Оборудование утилизировано"
        }
      ]
    },
    "locations": {
      "items": [
        {
          "locid": "EQU_LOC_UNKNOWN",
          "caption": "неизвестно",
          "def": "Положение оборудования неизвестно"
        },
        {
          "locid": "EQU_LOC_INWORK",
          "caption": "в эксплуатации",
          "def": "Оборудование находится в эксплуатации"
        },
        {
          "locid": "EQU_LOC_INREPAIR",
          "caption": "в ремонте",
          "def": "Оборудование находится в ремонте"
        },
        {
          "locid": "EQU_LOC_INSTOR",
          "caption": "на хранении",
          "def": "Оборудование находится на хранении"
        },
        {
          "locid": "EQU_LOC_INCHECK",
          "caption": "на поверке",
          "def": "Оборудование находится на поверке"
        }
      ]
    }
  }
}

```

**Возможные поля ответа:**

| **имя поля** | **тип**      | **описание**                                    |
|--------------|--------------|-------------------------------------------------|
| `stsid`      | `string[16]` | уникальный идентификатор статуса оборудования   |
| `locid`      | `string[16]` | уникальный идентификатор положения оборудования |
| `caption`    | `string`     | краткое наименование                            |
| `def`        | `string`     | описание                                        |

## 2. Список производителей оборудования

**Назначение:** для получения списка производителей оборудования, зарегистрированных в Датасервере

**Запрос:** `/api/v1/equipments/vendors/list`

**Тип запроса:**  POST

**Параметры тела запроса:**

| **имя поля**   | **тип**    | **описание**                                                               |
|----------------|------------|----------------------------------------------------------------------------|
| `page`         |            | текущая страница для отображения                                           | 
| `pagesize`     |            | кол-во элементов на странице для отображения. По умолчанию pagesize = 100  | 
| `venid`        | `[]uuid`   | массив идентификаторов производителей для выдачи                           | 
| `owner`        | `[]string` | массив владельцев производителя для выдачи                                 | 
| `shortname`    | `[]string` | массив сокращенного наименования производителя для выдачи                  | 
| `updatedFrom`  | `unixtime` | время начала обновления информации о производителе                         | 
| `updatedTo`    | `unixtime` | время окончания обновления информации о производителе                      |
| `searchStr`    | `string`   | строка поиска по полям из `searchBy`                                       | 
| `searchBy`     | `[]string` | устанавливает по каким полям делать поиск `searchStr`. Возможные значения: | 
| `-name`        | `opt`      | поиск по имени производтеля                                                | 
| `-sortname`    | `opt`      | поиск по полю сокращенного наименования производителя                      | 
| `order`        | `[]string` | устанавливает сортировку выдачи списка. Возможные значения в массиве:      | 
| `-venid`       | `opt`      | сортировка по идентификатору производителя                                 | 
| `-name`        | `opt`      | сортировка по имени производителя                                          | 
| `-shortname`   | `opt`      | сортировка по короткому наимениванию производителя                         | 
| `-owner`       | `opt`      | сортировка по идентификатору владельца производителя                       | 
| `-created`     | `opt`      | сортировка по времени создания записи о производителе                      | 
| `-updated`     | `opt`      | сортировка по времени обновления записи о производителе                    | 
| `-archived`    | `opt`      | сортировка по времени архивации производителя                              | 
| `-commited`    | `opt`      | сортировка по времени commited производителя                               | 
| `orderDir`     | `string`   | устанавливает направление сортировки выдачи списка. `asc` или `desc`       | 
| `flags`        | `[]string` | массив флагов. Возможные значения:                                         | 
| `-all`         | `opt`      | показать всех производителей                                               |
| `-archiveonly` | `opt`      | показать только архивные                                                   |
| `-verbose`     | `opt`      | выдавать все поля производителя                                            |

**Тело запроса:**

```json
{
  "venid": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b34",
    "6016ebf8-81a3-11e7-bb31-be2e44b06b35"
  ],
  "owner": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b36"
  ]
}
```

**Пример:**

`/api/v1/equipments/vendors/list`

**Ответ:** :

```json
{
  "info": {
    "page": 3,
    "pagecount": 3,
    "pagesize": 1000,
    "total": 3004
  },
  "vendors": [
    {
      "venid": "6016ebf8-81a3-11e7-bb31-be2e44b06b34",
      "owner": "6016ebf8-81a3-11e7-bb31-be2e44b06b34",
      "name": "XXXXXXXXXXXXXXXX",
      "shortname": "XXXXXXXXXXXXXXXX",
      "data": {
        "def": "", 
        "url": "site.com/bla-bla-bla-page.html",
      },
      "created": 1531412977,
      "updated": 1531412977,
      "commited": 1531412977,
      "archived": 1531412977,
      "deleted": 1531412977
    },
    {
      "venid": "6016ebf8-81a3-11e7-bb31-be2e44b06b35",
      "owner": null,
      "name": "XXXXXXXXXXXXXXXX",
      "shortname": "XXXXXXXXXXXXXXXX",
      "data": {
        "def": "", 
        "url": "site.com/bla-bla-bla-page.html",
      },
      "created": 1531412977,
      "updated": 1531412977,
      "commited": 1531412977,
      "archived": 1531412977,
      "deleted": 1531412977
    }
  ]
}
```

**Поля ответа:**

| **имя поля** | **тип**    | **описание**                           |
|--------------|------------|----------------------------------------|
| `venid`      | `uuid`     | уникальный идентификатор производителя |
| `name`       | `string`   | наименование производителя             |
| `shortname`  | `string`   | сокращенное наименование производителя |
| `owner`      | `uuid`     | идентификатор владельца производителя  |
| `data`       | `json`     | JSON-объект с данными производителя    |
| `created   ` | `unixtime` | время создания объекта в системе       | 
| `updated `   | `unixtime` | время обновления полей объекта         |
| `commited`   | `unixtime` | время коммита объекта в локальную базу |
| `archived`   | `unixtime` | время архивации объекта                |
| `deleted`    | `unixtime` | время удаления объекта                 |

## 3. Список групп оборудования

**Назначение:** для получения списка групп оборудования, зарегистрированных на Датасервере

**Запрос**: `/api/v1/equipments/groups/list`

**Тип запроса:**  POST

**Параметры тела запроса:**

| **имя поля**   | **тип**    | **описание**                                                               |
|----------------|------------|----------------------------------------------------------------------------|
| `page`         |            | текущая страница для отображения                                           | 
| `pagesize`     |            | кол-во элементов на странице для отображения. По умолчанию pagesize = 100  | 
| `eqgid`        | `[]uuid`   | массив ID для выдачи                                                       | 
| `owner`        | `[]string` | массив Owner для выдачи                                                    | 
| `updatedFrom`  | `unixtime` | время начала обновления объекта                                            | 
| `updatedTo`    | `unixtime` | время окончания обновления объекта                                         |
| `searchStr`    | `string`   | строка поиска по полям из `searchBy`                                       | 
| `searchBy`     | `[]string` | устанавливает по каким полям делать поиск `searchStr`. Возможные значения: | 
| `-name`        | `opt`      | поиск по имени объекта                                                     | 
| `order`        | `[]string` | устанавливает сортировку выдачи списка. Возможные значения в массиве:      | 
| `-id`          | `opt`      | сортировка по ID объекта                                                   | 
| `-name`        | `opt`      | сортировка по имени объекта                                                | 
| `-owner`       | `opt`      | сортировка по ID владельца объекта                                         | 
| `-created`     | `opt`      | сортировка по времени создания записи об объекте                           | 
| `-updated`     | `opt`      | сортировка по времени обновления записи об объекте                         | 
| `-archived`    | `opt`      | сортировка по времени архивации объекта                                    | 
| `-commited`    | `opt`      | сортировка по времени commited объекта                                     | 
| `orderDir`     | `string`   | устанавливает направление сортировки выдачи списка. `asc` или `desc`       | 
| `flags`        | `[]string` | массив флагов. Возможные значения:                                         | 
| `-all`         | `opt`      | показать все объекты                                                       |
| `-archiveonly` | `opt`      | показать только архивные                                                   |
| `-verbose`     | `opt`      | выдавать все поля объекта                                                  |

**Тело запроса:**

```json
{
  "eqgid": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b34",
    "6016ebf8-81a3-11e7-bb31-be2e44b06b35"
  ],
  "owner": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b36"
  ]
}
```

**Пример:**
`/api/v1/equipments/groups/list`

**Ответ:** :

```json
{
  "info": {
    "page": 3,
    "pagecount": 3,
    "pagesize": 1000,
    "total": 3004
  },
  "eqgroups": [
    {
      "eqgid": "845a90bf-ba58-11e7-8269-e069955b7462",
      "owner": null,
      "name": "Термометры",
      "data": {
        "def": ""
      },
      "created": 1531412977,
      "updated": 1531412977,
      "commited": 1531412977,
      "archived": 1531412977,
      "deleted": 1531412977
    },
    {
      "eqgid": "845a90bf-ba58-11e7-8269-e069955b7462",
      "owner": "45a90bf-ba58-11e7-8269-69955b7462",
      "name": "Термометры ртутные",
      "data": {
        "def": ""
      },
      "created": 1531412977,
      "updated": 1531412977,
      "commited": 1531412977,
      "archived": 1531412977,
      "deleted": 1531412977
    }
  ]
}
```

**Поля ответа:**

| **имя поля** | **тип**    | **описание**                           |
|--------------|------------|----------------------------------------|
| `eqgid`      | `uuid`     | уникальный идентификатор объекта       |
| `name`       | `string`   | наименование объекта                   |
| `owner`      | `uuid`     | идентификатор владельца объекта        |
| `data`       | `json`     | JSON-объект с данными объекта          |
| `created   ` | `unixtime` | время создания объекта в системе       | 
| `updated `   | `unixtime` | время обновления полей объекта         |
| `commited`   | `unixtime` | время коммита объекта в локальную базу |
| `archived`   | `unixtime` | время архивации объекта                |
| `deleted`    | `unixtime` | время удаления объекта                 |

## 4. Список типов оборудования

**Назначение:** для получения списка типов оборудования и моделей, зарегистрированных на Датасервере.

**Запрос**: `/api/v1/equipments/types/list`

**Тип запроса:**  POST

**Параметры тела запроса:**

| **имя поля**   | **тип**    | **описание**                                                               |
|----------------|------------|----------------------------------------------------------------------------|
| `page`         |            | текущая страница для отображения                                           | 
| `pagesize`     |            | кол-во элементов на странице для отображения. По умолчанию pagesize = 100  | 
| `eqtid`        | `[]uuid`   | массив ID для выдачи                                                       | 
| `eqgid`        | `[]uuid`   | массив групп типов оборудования для выдачи                                 | 
| `venid`        | `[]uuid`   | массив идентификаторов производителей для выдачи                           | 
| `name`         | `[]string` | массив наименований обоуудования для выдачи                                | 
| `eqkind`       | `[]string` | массив типов обоуудования от производителя для выдачи                      | 
| `model`        | `[]string` | массив моделей обоурдования для выдачи                                     | 
| `updatedFrom`  | `unixtime` | время начала обновления объекта                                            | 
| `updatedTo`    | `unixtime` | время окончания обновления объекта                                         |
| `searchStr`    | `string`   | строка поиска по полям из `searchBy`                                       | 
| `searchBy`     | `[]string` | устанавливает по каким полям делать поиск `searchStr`. Возможные значения: | 
| `-name`        | `opt`      | поиск по имени объекта                                                     | 
| `-eqkind`      | `opt`      | поиск по типов обоуудования от производителя                               | 
| `-model`       | `opt`      | поиск по моделей обоурдования                                              | 
| `order`        | `[]string` | устанавливает сортировку выдачи списка. Возможные значения в массиве:      | 
| `-eqid`        | `opt`      | сортировка по ID объекта                                                   | 
| `-name`        | `opt`      | сортировка по имени объекта                                                | 
| `-created`     | `opt`      | сортировка по времени создания записи об объекте                           | 
| `-updated`     | `opt`      | сортировка по времени обновления записи об объекте                         | 
| `-archived`    | `opt`      | сортировка по времени архивации объекта                                    | 
| `-commited`    | `opt`      | сортировка по времени commited объекта                                     | 
| `-venid`       | `opt`      | сортировка по производтелю                                                 | 
| `-eqkind`      | `opt`      | сортировка по типов обоуудования от производителя                          | 
| `-model`       | `opt`      | сортировка по моделей обоурдования                                         | 
| `orderDir`     | `string`   | устанавливает направление сортировки выдачи списка. `asc` или `desc`       | 
| `flags`        | `[]string` | массив флагов. Возможные значения:                                         | 
| `-all`         | `opt`      | показать все объекты                                                       |
| `-archiveonly` | `opt`      | показать только архивные                                                   |
| `-verbose`     | `opt`      | выдавать все поля объекта                                                  |

**Тело запроса:**

```json
{
  "eqtid": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b34",
    "6016ebf8-81a3-11e7-bb31-be2e44b06b35"
  ],
  "eqgid": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b36",
    "6016ebf8-81a3-11e7-bb31-be2e44b06b35"
  ]
}
```

**Пример:**
`/api/v1/equipments/types/list`

**Ответ:** :

```json
{
  "info": {
    "page": 3,
    "pagecount": 3,
    "pagesize": 1000,
    "total": 3004
  },
  "eqtypes": [
    {
      "name": "AWS/Model 1",
      "eqtid": "74960958-de03-4095-9f5e-35f6d16f45",
      "venid": "74960958-de03-4095-9f5e-35f6d16f45",
      "eqkind": "AWS",
      "model": "Model 1",
      
      "data": {
        "def": "",

        "checks": {
          "check_per": 12,
          "check_per_type": "month"
        },

        "eqgid": [
          "74960958-de03-4095-9f5e-35f6dc016f45",
          "74960958-de03-4095-9f5e-35f6dc016f46",
          "74960958-de03-4095-9f5e-35f6dc016f47"
        ],

        "url": "site.com/bla-bla-bla-page.html",

        "wigos": {},

        "images": [
          {
            "name": "filename.bmp",
            "ext": ".bmp",
            "type": "image / bmp",
            "size": 512012,
            "body": "b64 file content"
          },
          {
            "name": "filename.bmp",
            "ext": ".bmp",
            "type": "image / bmp",
            "size": 512012,
            "body": "b64 file content"
          }
        ]  
      },
      "created": 1531412977,
      "updated": 1531412977,
      "commited": 1531412977,
      "archived": 1531412977,
      "deleted": 1531412977,
    },
    {
      "name": "AWS/Model 1",
      "eqtid": "74960958-de03-4095-9f5e-35f6d16f45",
      "venid": "74960958-de03-4095-9f5e-35f6d16f45",
      "eqkind": "AWS",
      "model": "Model 2",
      
      "data": {
        "def": "",

        "checks": {
          "check_per": 12,
          "check_per_type": "month"
        },

        "eqgid": [
          "74960958-de03-4095-9f5e-35f6dc016f45",
          "74960958-de03-4095-9f5e-35f6dc016f46",
          "74960958-de03-4095-9f5e-35f6dc016f47"
        ],

        "url": "site.com/bla-bla-bla-page.html",

        "wigos": {},

        "images": [
          {
            "name": "filename.bmp",
            "ext": ".bmp",
            "type": "image / bmp",
            "size": 512012,
            "body": "b64 file content"
          },
          {
            "name": "filename.bmp",
            "ext": ".bmp",
            "type": "image / bmp",
            "size": 512012,
            "body": "b64 file content"
          }
        ]  
      },
      "created": 1531412977,
      "updated": 1531412977,
      "commited": 1531412977,
      "archived": 1531412977,
      "deleted": 1531412977,
    }
  ]
}
```

**Поля ответа:**

| **имя поля**     | **тип**  | **описание**                                                 |
|------------------|----------|--------------------------------------------------------------|
| `eqtid`          | `uuid`   | уникальный идентификатор типа и модели оборудования          |
| `eqkind`         | `string` | уникальный идентификатор типа оборудования от производителя  |
| `venid`          | `uuid`   | уникальный идентификатор производителя оборудования          |
| `def`            | `json`   | описание оборудования в формате объекта JSON                 |
| `model`          | `string` | наименование модели оборудования от производителя            |
| `check_per`      | `int`    | межповерочный интервал                                       |
| `check_per_type` | `string` | тип межповерочный интервала (годы/месяцы/дни)                |
| `groups`         | `[]uuid` | список групп оборудования, куда входит тип оборудование      |
| `wigos`          | `json`   | описание оборудования по стандарту WIGOS в виде объекта JSON |
| `url`            | `url`    | ссылка на страничку типа оборудования в сети интернет        |
| `images`         | `array`  | данные изображений                                           |

## 5. Список экземпляров оборудования

**Назначение:** для получения списка экземпляров оборудования.

Каждый экземпляр может быть в некотором статусе (неизвестно, исправное, неисправное, утилизированное) и в месте
нахождения (неизвестно, в работе, в ремонте, на хранении, на поверке).

Оборудование может быть привязано к Источнику (поле sid) и/или к Отделению организации (поле depts) и/или к Компании (
поле compid).

**Запрос** `/api/v1/equipments/list`

**Тип запроса:**  POST

**Параметры тела запроса:**

| **имя поля**   | **тип**          | **описание**                                                               |
|----------------|------------------|----------------------------------------------------------------------------|
| `page`         |                  | текущая страница для отображения                                           | 
| `pagesize`     |                  | кол-во элементов на странице для отображения. По умолчанию pagesize = 100  | 
| `eqid`         | `[]uuid`         | массив ID для выдачи                                                       | 
| `compid`       | `[]string`       | массив CompID для выдачи                                                   | 
| `depid`        | `[]string`       | массив DepID для выдачи                                                    | 
| `owner`        | `[]string`       | массив Owner для выдачи                                                    | 
| `eqkind`       | `[]string`       | массив типов обоурдования от производителя для выдачи                      | 
| `sid`          | `[]string`       | массив источников для выдачи                                               | 
| `dataFilters`  | `DataFilterList` | фильтр по полям data (необ.)                                               | 
| `updatedFrom`  | `unixtime`       | время начала обновления объекта                                            | 
| `updatedTo`    | `unixtime`       | время окончания обновления объекта                                         |
| `searchStr`    | `string`         | строка поиска по полям из `searchBy`                                       | 
| `searchBy`     | `[]string`       | устанавливает по каким полям делать поиск `searchStr`. Возможные значения: | 
| `-name`        | `opt`            | поиск по имени объекта                                                     | 
| `-eqkind`      | `opt`            | поиск по полю типа оборудования от производителя                           | 
| `-sid`         | `opt`            | поиск по полю общего назначения 2                                          | 
| `order`        | `[]string`       | устанавливает сортировку выдачи списка. Возможные значения в массиве:      | 
| `-eqid`        | `opt`            | сортировка по ID объекта                                                   | 
| `-name`        | `opt`            | сортировка по имени объекта                                                | 
| `-compid`      | `opt`            | сортировка по организации  объекта                                         | 
| `-depid`       | `opt`            | сортировка по подразделелю организации  объекта                            | 
| `-owner`       | `opt`            | сортировка по ID владельца объекта                                         | 
| `-created`     | `opt`            | сортировка по времени создания записи об объекте                           | 
| `-updated`     | `opt`            | сортировка по времени обновления записи об объекте                         | 
| `-archived`    | `opt`            | сортировка по времени архивации объекта                                    | 
| `-commited`    | `opt`            | сортировка по времени commited объекта                                     | 
| `-eqkind`      | `opt`            | сортировка по типу оборудования от производителя                           | 
| `-sid`         | `opt`            | сортировка по источнику                                                    | 
| `orderDir`     | `string`         | устанавливает направление сортировки выдачи списка. `asc` или `desc`       | 
| `flags`        | `[]string`       | массив флагов. Возможные значения:                                         | 
| `-all`         | `opt`            | показать все объекты                                                       |
| `-archiveonly` | `opt`            | показать только архивные                                                   |
| `-verbose`     | `opt`            | выдавать все поля объекта                                                  |

**Тело запроса:**

```json
{
  "eqid": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b34",
    "6016ebf8-81a3-11e7-bb31-be2e44b06b35"
  ],
  "owner": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b36"
  ],
  "compid": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b36"
  ],
  "depid": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b36"
  ]
}
```

**Пример:**

* `/api/v1/equipments/list`
* `/api/v1/equipments/list?page=2&flag=archiveonly`
* `/api/v1/equipments/list?name=Терм*&sid=RU61-012345-0000, RU61-012345-0001`

**Ответ:**

```json

{
  "meta": {},
  "response": {
    "equipments": {
      "info": {
        "page": 0,
        "pagecount": 1,
        "pagesize": 100,
        "total": 3
      },
      "items": [
        {
          "name": "Термометр",
          "eqid": "c2caaaaa-ed42-11ce-bacd-00aa0057b111", 
          "compid": "ccaaaaa-ed42-11ce-bacd-00aa0057b111",
          "deptid": "ccaaaaa-ed42-11ce-bacd-00aa0057b111",
          "owner": " c2caaaaa-ed42-11ce-bacd-00aa07b111", 

          "eqkind": "AWS",
          "sid": "XXXX-YINDEX-ZZZ",

          "archived": 1505299738,
          "updated": 1504620923,
          "created": 1504620923,
          
          "data": {
            "def": "текст",

            "sernum": "AAA0001",
            "invnum": "BBB0001",

            "driver": {
              "params": {     
                "index": "A9218",
              },
              "drvid": "74960958-de03-4095-9f5e-35f6d16f46"
            },

            "eqtid": "74960958-de03-4095-9f5e-35f6d16f45",

            "set_to": "74960958-de03-4095-9f5e-35f6d16f45",

            "status": "EQU_STS_UNKNOWN",
            "location": "EQU_LOC_INSTOR",

            "mid": "cccc1232-ed42-11ce-bacd-00aa00000002"

          }  
        },

        {
          "name": "Плювиограф",
          "eqid": "c2caaaaa-ed42-11ce-bacd-00aa0057b111", 
          "compid": "ccaaaaa-ed42-11ce-bacd-00aa0057b111",
          "deptid": "ccaaaaa-ed42-11ce-bacd-00aa0057b111",
          "owner": " c2caaaaa-ed42-11ce-bacd-00aa07b111", 

          "eqkind": "AWS",
          "sid": "XXXX-YINDEX-ZZZ",

          "archived": 1505299738,
          "updated": 1504620923,
          "created": 1504620923,
          
          "data": {
            "def": "текст",

            "sernum": "AAA0001",
            "invnum": "BBB0001",

            "driver": {
              "params": {     
                "index": "A9218",
              },
              "drvid": "74960958-de03-4095-9f5e-35f6d16f46"
            },

            "eqtid": "74960958-de03-4095-9f5e-35f6d16f45",

            "set_to": "74960958-de03-4095-9f5e-35f6d16f45",

            "status": "EQU_STS_UNKNOWN",
            "location": "EQU_LOC_INSTOR",

            "mid": "cccc1232-ed42-11ce-bacd-00aa00000002"

          }  
        }
      ]
    }
  }
}
```

**Возможные поля ответа:**

| **имя поля**      | **тип**    | **описание**                                                                                           |
|-------------------|------------|--------------------------------------------------------------------------------------------------------|
| `page`            | `string`   | текущий номер страницы (дублирует параметр запроса)                                                    |
| `pagecount`       | `string`   | общее число страниц (зависит от размера pagesize)                                                      |
| `pagesize`        | `string`   | сколько элементов выдавать на странице (дублирует параметр запроса)                                    |
| `total`           | `string`   | всего элементов в таблице                                                                              |
| `name`            | `string`   | наименование оборудования (произвольный текст)                                                         |
| `eqid`            | `uuid`     | уникальный идентификатор экземпляра оборудования                                                       |
| `eqtid`           | `uuid`     | уникальный идентификатор записи таблицы типов оборудования                                             |
| `eqkind`          | `string`   | уникальный идентификатор типа оборудования                                                             |
| `sid`             | `string`   | идентификатор источника, к которому привязано оборудование                                             |
| `compid`          | `uuid`     | уникальный идентификатор **компани-собственника** оборудования                                         |
| `deptid`          | `uuid`     | уникальный идентификатор **отдела-собственника** оборудования                                          |
| `lid`             | `uuid`     | уникальный идентификатор линка, связанного с оборудованием                                             |
| `hid`             | `string`   | уникальный идентификатор узла связанный с оборудованием                                                |
| `check_per`       | `int`      | межповерочный интервал в месяцах                                                                       |
| `set_to`          | `uuid`     | уникальный идентификатор оборудования или персонала к которому прикреплено оборудование                |
| `mid`             | `uuid`     | уникальный идентификатор метаданных экземпляра оборудования                                            |
| `status`          | `string`   | статус оборудования                                                                                    |
| `location`        | `string`   | место нахождения прибора                                                                               |
| `sernum`          | `string`   | серийный номер оборудования (уникальный для всех экземпляров данного типа оборудования)                |
| `invnum`          | `string`   | необязательный инвентарный номер оборудования (уникальный для всех экземпляров оборудования в системе) |
| `index`           | `string`   | индекс оборудования - идентификатор оборудования в посылке данных                                      |
| `model`           | `string`   | наименование модели оборудования                                                                       |
| `manuf_time`      | `unixtime` | датаизготовления                                                                                       |
| `comiss_time`     | `unixtime` | дата ввода в эксплуатацию                                                                              |
| `price`           | `integer`  | цена                                                                                                   |
| `last_check_time` | `unixtime` | время последней поверки оборудования                                                                   |
| `next_check_time` | `unixtime` | время следующей поверки оборудования                                                                   |
| `archived`        | `unixtime` | время архивации записи об оборудовании                                                                 |
| `created`         | `unixtime` | время создания сущности                                                                                |
| `updated`         | `unixtime` | время обновления сущности                                                                              |

## 6. Информация по указанному оборудованию

**Назначение:** для получения характеристик по указанному экземпляру оборудования.

**Запрос** `/api/v1/equipments/EQU_ID`

где `EQU_ID` – идентификатор экземпляра оборудования

**Тип запроса:** GET

**Возможные параметры:** нет

**Пример:**  `/api/v1/equipments/dea50f0c-f55f-4063-9f17-e45ae8c03bce`

**Ответ:**

```json

{
  "meta": {},
  "response": {
    "equipment": {
      "name": "Термометр",
      "eqid": "c2caaaaa-ed42-11ce-bacd-00aa0057b111", 
      "compid": "ccaaaaa-ed42-11ce-bacd-00aa0057b111",
      "deptid": "ccaaaaa-ed42-11ce-bacd-00aa0057b111",
      "owner": " c2caaaaa-ed42-11ce-bacd-00aa07b111", 

      "eqkind": "AWS",
      "sid": "XXXX-YINDEX-ZZZ",

      "archived": 1505299738,
      "updated": 1504620923,
      "created": 1504620923,
          
      "data": {
        "def": "текст",

        "sernum": "AAA0001",
        "invnum": "BBB0001",

        "driver": {
          "params": {     
            "index": "A9218",
          },
          "drvid": "74960958-de03-4095-9f5e-35f6d16f46"
        },

        "eqtid": "74960958-de03-4095-9f5e-35f6d16f45",

        "set_to": "74960958-de03-4095-9f5e-35f6d16f45",

        "status": "EQU_STS_UNKNOWN",
        "location": "EQU_LOC_INSTOR",

        "mid": "cccc1232-ed42-11ce-bacd-00aa00000002"

      }, 

      "body": {
        "docs": [
          "74960958-de03-4095-9f5e-35f6dc016f45", 
          "74960958-de03-4095-9f5e-35f6dc016f45"
        ],

        "history": {
          "manuf_time": 1505299738,
          "execute_time": 1505299738,
          "comiss_time": 1505299738,
        },

        "checks": {
          "last_check_time": 1505299738,
          "next_check_time": 1505299738,
          "check_per": 12,
          "check_per_type": "month",
         
          "history": [
            {
              "num": 1,
              "checkid": "74960958-de03-4095-9f5e-35f6d16f45",
            },
            {
              "num": 2,
              "checkid": "74960958-de03-4095-9f5e-35f6d16f45",
            }
          ]
        },  

        "buy": {
           "price": 10000,
        },

        "wigos": {}
          
      }
    }
  }
}
```

**Возможные поля ответа:**

| **имя поля**      | **тип**    | **описание**                                                                                           |
|-------------------|------------|--------------------------------------------------------------------------------------------------------|
| `name`            | `string`   | наименование оборудования (произвольный текст)                                                         |
| `eqid`            | `uuid`     | уникальный идентификатор экземпляра оборудования                                                       |
| `eqtid`           | `uuid`     | уникальный идентификатор записи таблицы типов оборудования                                             |
| `eqkind`          | `string`   | уникальный идентификатор типа оборудования                                                             |
| `sid`             | `string`   | идентификатор источника, к которому привязано оборудование                                             |
| `lid`             | `uuid`     | уникальный идентификатор линка, связанного с оборудованием                                             |
| `deptid`          | `uuid`     | уникальный идентификатор **отдела-собственника** оборудования                                          |
| `compid`          | `uuid`     | уникальный идентификатор **компании-собственника** оборудования                                        |
| `check_per`       | `int`      | межповерочный интервал в месяцах                                                                       |
| `hid `            | `string`   | уникальный идентификатор узла связанный с оборудованием                                                |
| `manuf_time`      | `unixtime` | дата изготовления                                                                                      |
| `comiss_time`     | `unixtime` | дата ввода в эксплуатацию                                                                              |
| `price`           | `integer`  | цена                                                                                                   |
| `docs`            | `string`   | уникальный идентификатор группы файлов с документами экземпляра оборудования                           |
| `owner`           | `uuid`     | уникальный идентификатор оборудования, к которому подключено текущее                                   |
| `set_to`          | `uuid`     | уникальный идентификатор оборудования или персонала к которому прикреплено оборудование                |
| `mid`             | `uuid`     | уникальный идентификатор метаданных экземпляра оборудования                                            |
| `status`          | `string`   | статус оборудования                                                                                    |
| `location`        | `string`   | место нахождения прибора                                                                               |
| `sernum`          | `string`   | серийный номер оборудования (уникальный для всех экземпляров данного типа оборудования)                |
| `invnum`          | `string`   | необязательный инвентарный номер оборудования (уникальный для всех экземпляров оборудования в системе) |
| `index`           | `string`   | индекс оборудования - идентификатор оборудования в посылке данных                                      |
| `model`           | `string`   | наименование модели оборудования                                                                       |
| `wigos`           | `json`     | описание оборудования по стандарту WIGOS в виде объекта JSON                                           |
| `check_time`      | `unixtime` | время последней поверки оборудования                                                                   |
| `next_check_time` | `unixtime` | время следующей поверки оборудования                                                                   |
| `archived `       | `unixtime` | время архивации записи об оборудовании                                                                 |
| `created`         | `unixtime` | время создания записи об оборудовании                                                                  |
| `updated`         | `unixtime` | время обновления записи об оборудовании                                                                |
| `def`             | `text`     | произвольный текст пользователя                                                                        |

## 7. Создать новую запись об оборудовании

**Назначение:** для создания новой записи об экземпляре оборудования.

При создании записи должно проверяться поле **eqtid** (тип оборудования) среди зарегистрированных типов оборудования.

Если такого тип отсутствует – возвращать ошибку. Также необходимо проверять соответствие формату JSON поля **wigos**.
Запись должна быть уникальна по eqtid+sernum

После создания записи об оборудовании его статус устанавливается в EQU_STS_UNKNOWN и местоположение устанавливается в
EQU_LOC_INSTOR.

**Запрос** `/api/v1/equipments/new`

**Тип запроса:** POST

**Пример:**  `/api/v1/equipments/new`

**Передаваемые данные:**

```json

{
    "equipment": {
      "name": "Термометр",
      "eqid": "c2caaaaa-ed42-11ce-bacd-00aa0057b111", 
      "compid": "ccaaaaa-ed42-11ce-bacd-00aa0057b111",
      "deptid": "ccaaaaa-ed42-11ce-bacd-00aa0057b111",
      "owner": " c2caaaaa-ed42-11ce-bacd-00aa07b111", 

      "eqkind": "AWS",
      "sid": "XXXX-YINDEX-ZZZ",

      "archived": 1505299738,
      "updated": 1504620923,
      "created": 1504620923,
          
      "data": {
        "def": "текст",

        "sernum": "AAA0001",
        "invnum": "BBB0001",

        "driver": {
          "params": {     
            "index": "A9218",
          },
          "drvid": "74960958-de03-4095-9f5e-35f6d16f46"
        },

        "eqtid": "74960958-de03-4095-9f5e-35f6d16f45",

        "set_to": "74960958-de03-4095-9f5e-35f6d16f45",

        "status": "EQU_STS_UNKNOWN",
        "location": "EQU_LOC_INSTOR",

        "mid": "cccc1232-ed42-11ce-bacd-00aa00000002"

      }, 

      "body": {
        "docs": [
          "74960958-de03-4095-9f5e-35f6dc016f45", 
          "74960958-de03-4095-9f5e-35f6dc016f45"
        ],

        "history": {
          "manuf_time": 1505299738,
          "execute_time": 1505299738,
          "comiss_time": 1505299738,
        },

        "checks": {
          "last_check_time": 1505299738,
          "next_check_time": 1505299738,
          "check_per": 12,
          "check_per_type": "month",
         
          "history": [
            {
              "num": 1,
              "checkid": "74960958-de03-4095-9f5e-35f6d16f45",
            },
            {
              "num": 2,
              "checkid": "74960958-de03-4095-9f5e-35f6d16f45",
            }
          ]
        },  

        "buy": {
           "price": 10000,
        },

        "wigos": {}
          
      }
    }
}

```

**Ответ:**

```json

{
  "meta": {},
  "response": {
    "equipment": {
      "eqid": "dea50f0c-f55f-4063-9f17-e45ae8c03bce"
    }
  }
}

```

**Обязательные параметры:**

| **имя поля** | **тип**      | **описание**                                                |
|--------------|--------------|-------------------------------------------------------------|
| `eqtid`      | `uuid`       | уникальный идентификатор записи таблицы типов оборудования  |
| `sernum`     | `string[16]` | серийный номер оборудования                                 |
| `compid`     | `uuid`       | уникальный идентификатор компании-собственника оборудования |

**Необязательные параметры:**

| **имя поля**      | **тип**    | **описание**                                                                                           |
|-------------------|------------|--------------------------------------------------------------------------------------------------------|
| `name`            | `string`   | наименование оборудования (произвольный текст)                                                         |
| `eqid`            | `uuid`     | уникальный идентификатор экземпляра оборудования                                                       |
| `sid`             | `string`   | идентификатор станции, на которой размещено оборудование                                               |
| `deptid`          | `uuid`     | уникальный идентификатор отдела-собственника оборудования                                              |
| `lid`             | `uuid`     | уникальный идентификатор линка, связанного с оборудованием                                             |
| `hid`             | `string`   | уникальный идентификатор узла связанный с оборудованием                                                |
| `invnum`          | `string`   | необязательный инвентарный номер оборудования (уникальный для всех экземпляров оборудования в системе) |
| `docs`            | `[]uuid]`  | уникальный идентификатор записи с документами экземпляра оборудования                                  |
| `owner`           | `uuid`     | уникальный идентификатор оборудования, к которому подключено текущее                                   |
| `set_to`          | `uuid`     | уникальный идентификатор оборудования или персонала к которому прикреплено оборудование                |
| `status`          | `string`   | статус оборудования                                                                                    |
| `location`        | `string`   | место нахождения прибора                                                                               |
| `index`           | `string`   | индекс оборудования - идентификатор оборудования в посылке данных                                      |
| `mid`             | `uuid`     | уникальный идентификатор метаданных экземпляра оборудования                                            |
| `wigos`           | `json`     | описание оборудования по стандарту WIGOS в виде объекта JSON                                           |
| `check_time`      | `unixtime` | время последней поверки оборудования                                                                   |
| `next_check_time` | `unixtime` | время следующей поверки оборудования                                                                   |
| `def`             | `text`     | произвольный текст пользователя                                                                        |
| `mid`             | `uuid`     | идентификатор создаваемых метаданных связанных с записью                                               |

**Возможные поля ответа:**

| **имя поля** | **тип** | **описание**                                     |
|--------------|---------|--------------------------------------------------|
| `eqid`       | `uuid`  | уникальный идентификатор экземпляра оборудования |

**Примечания:**

* поля "eqkind" и "model" при созаднии не указываются, а должны получаться из обязательно указанного "eqtid"
* Если не задано поле "name" то оно должно инициализироваться в значения "eqkind"/"model"

## 8. Обновить характеристики оборудования

**Назначение:** для обновления характеристик экземпляра оборудования.

Обновляются указанные в запросе поля.

Следующие поля нельзя обновить: **mid, eqid, eqtid, eqkind, model, hid, sernum, compid**.

Также необходимо проверять соответствие формату JSON поля **wigos**.

**Запрос** `/api/v1/equipments/EQU_ID/update`

**Тип запроса:** POST

**Пример:**  `/api/v1/equipments/dea50f0c-f55f-4063-9f17-e45ae8c03bce/update`

**Передаваемые данные:**

```json

{
    "equipment": {
      "name": "Термометр",
      "deptid": "ccaaaaa-ed42-11ce-bacd-00aa0057b111",
      "owner": " c2caaaaa-ed42-11ce-bacd-00aa07b111", 

      "sid": "XXXX-YINDEX-ZZZ",

      "data": {
        "def": "текст",

        "invnum": "BBB0001",

        "driver": {
          "params": {     
            "index": "A9218",
          },
          "drvid": "74960958-de03-4095-9f5e-35f6d16f46"
        },

        "set_to": "74960958-de03-4095-9f5e-35f6d16f45",

        "status": "EQU_STS_UNKNOWN",
        "location": "EQU_LOC_INSTOR",

        "mid": "cccc1232-ed42-11ce-bacd-00aa00000002"

      }, 

      "body": {
        "docs": [
          "74960958-de03-4095-9f5e-35f6dc016f45", 
          "74960958-de03-4095-9f5e-35f6dc016f45"
        ],

        "history": {
          "manuf_time": 1505299738,
          "execute_time": 1505299738,
          "comiss_time": 1505299738,
        },

        "checks": {
          "last_check_time": 1505299738,
          "next_check_time": 1505299738,
          "check_per": 12,
          "check_per_type": "month",
         
          "history": [
            {
              "num": 1,
              "checkid": "74960958-de03-4095-9f5e-35f6d16f45",
            },
            {
              "num": 2,
              "checkid": "74960958-de03-4095-9f5e-35f6d16f45",
            }
          ]
        },  

        "buy": {
           "price": 10000,
        },

        "wigos": {}
          
      }
    }
}

```

**Ответ:**

```json

{
  "meta": {},
  "response": {}
}

```

**Возможные поля запроса:**

| **имя поля**      | **тип**    | **описание**                                                                                           |
|-------------------|------------|--------------------------------------------------------------------------------------------------------|
| `name`            | `string`   | наименование оборудования (произвольный текст)                                                         |
| `sid`             | `string`   | идентификатор станции, на которой размещено оборудование                                               |
| `deptid`          | `uuid`     | уникальный идентификатор отдела-собственника оборудования                                              |
| `lid`             | `uuid`     | уникальный идентификатор линка, связанного с оборудованием                                             |
| `hid`             | `string`   | уникальный идентификатор узла связанный с оборудованием                                                |
| `invnum`          | `string`   | необязательный инвентарный номер оборудования (уникальный для всех экземпляров оборудования в системе) |
| `docs`            | `[]uuid]`  | уникальный идентификатор записи с документами экземпляра оборудования                                  |
| `owner`           | `uuid`     | уникальный идентификатор оборудования, к которому подключено текущее                                   |
| `set_to`          | `uuid`     | уникальный идентификатор оборудования или персонала к которому прикреплено оборудование                |
| `status`          | `string`   | статус оборудования                                                                                    |
| `location`        | `string`   | место нахождения прибора                                                                               |
| `index`           | `string`   | индекс оборудования - идентификатор оборудования в посылке данных                                      |
| `wigos`           | `json`     | описание оборудования по стандарту WIGOS в виде объекта JSON                                           |
| `check_time`      | `unixtime` | время последней поверки оборудования                                                                   |
| `next_check_time` | `unixtime` | время следующей поверки оборудования                                                                   |
| `def`             | `text`     | произвольный текст пользователя                                                                        |

## 9. Архивировать запись об оборудовании

**Назначение:** для архивации записи об экземпляре оборудования.

**Запрос** `/api/v1/equipments/archive?eqid=EQU_ID`

**Тип запроса:** POST

**Параметры запроса:**

| **имя поля** | **тип** | **описание**                          |
|--------------|---------|---------------------------------------|
| `eqid`       |         | уникальный идентификатор оборудования |

**Пример:**  `/api/v1/equipments/archive?eqid=dea50f0c-f55f-4063-9f17-e45ae8c03bce`

**Ответ:**

```json

{
  "meta": {},
  "response": {}
}

```

## 10. Восстановить запись об оборудовании

**Назначение:** для восстановления ранее архивированной записи об оборудовании.

**Запрос** `/api/v1/equipments/restore?eqid=EQU_ID`

**Тип запроса:** POST

**Параметры запроса:**

| **имя поля** | **тип** | **описание**                          |
|--------------|---------|---------------------------------------|
| `eqid`       |         | уникальный идентификатор оборудования |

**Пример:**  `/api/v1/equipments/restore?eqid=dea50f0c-f55f-4063-9f17-e45ae8c03bce`

**Ответ:**

```json

{
  "meta": {},
  "response": {}
}

```

## 11. Удалить запись об оборудовании

**Назначение:** для удаления записи об оборудовании.

**Запрос** `/api/v1/equipments/rem?eqid=EQU_ID`

**Тип запроса:** POST

**Параметры запроса:**

| **имя поля** | **тип** | **описание**                          |
|--------------|---------|---------------------------------------|
| `eqid`       |         | уникальный идентификатор оборудования |

**Пример:**  `/api/v1/equipments/rem?eqid=dea50f0c-f55f-4063-9f17-e45ae8c03bce`

**Ответ:**

```json

{
  "meta": {},
  "response": {}
}

```

